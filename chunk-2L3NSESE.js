import{a as k,d as L,e as b}from"./chunk-QFS3ZCNV.js";import{a as K,b as Q,c as W,d as X,e as Z,f as tt}from"./chunk-AMLJPPLR.js";import{$,M as R,N as B,R as D,S as s,U as O,V as q,X as G,Y as z,Z as U,_ as Y,ba as j,c as F,ca as H,d as I,da as J,k as w,m as T,n as V}from"./chunk-UJAUFW42.js";import{$a as P,Nb as n,Oa as m,Ob as _,P as M,Qb as v,Rb as C,Y as l,cb as E,fa as A,h as x,nb as u,ob as d,pb as f,qb as i,rb as o,sb as h,y,yb as S,zb as N}from"./chunk-644IJ2L6.js";var g=class e{transform(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}static \u0275fac=function(r){return new(r||e)};static \u0275pipe=E({name:"capitalize",type:e,pure:!0})};var at=["class","component"];function ot(e,t){e&1&&n(0," Loggin in ")}function nt(e,t){e&1&&n(0," Create an account ")}function rt(e,t){e&1&&(i(0,"mat-form-field",4)(1,"mat-label"),n(2,"Your name"),o(),h(3,"input",12),i(4,"mat-icon",6),n(5,"person"),o()())}function mt(e,t){if(e&1&&(i(0,"div",9),n(1),o()),e&2){let r=N();m(),_(r.errorMessage)}}function lt(e,t){e&1&&(i(0,"span",13),n(1,"Not registered? "),o(),i(2,"a",14),n(3,"Create an account"),o())}function st(e,t){e&1&&(i(0,"span",13),n(1,"Already have an account? "),o(),i(2,"a",15),n(3,"Log in"),o())}var et=class e{loaderService=l(k);_route=l(w);_router=l(T);_authService=l(L);_fb=l(Y);authState={state:"login"};errorMessage=null;hidePassword=!0;_destroyRef=l(A);authForm=this._fb.group({email:["",[s.required,s.email]],password:["",[s.required,s.minLength(6)]],displayName:[""]});constructor(){this._route.url.pipe(b()).subscribe(t=>{this.authState.state=t[0].path==="login"?"login":"register",this.updateValidators()})}ngOnInit(){}onSubmit(){if(this.authForm.invalid)return;this.errorMessage=null;let{email:t,password:r,displayName:a}=this.authForm.getRawValue();(this.authState.state==="login"?this._authService.signIn(t,r):this._authService.signUp(t,r,a)).pipe(M(()=>{this._router.navigate(["/home"])}),y(c=>(this.errorMessage=c.message||"Auth error",x)),b(this._destroyRef)).subscribe()}updateValidators(){let t=this.authForm.controls.displayName;this.authState.state==="login"?t.clearValidators():t.setValidators([s.required]),t.updateValueAndValidity()}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=P({type:e,selectors:[["auth",8,"component"]],attrs:at,decls:29,vars:13,consts:[[1,"auth-page","flex-column","flex-center"],[1,"auth-page__container"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"auth-form__title"],["appearance","outline",1,"auth-form__field"],["matInput","","formControlName","email","type","email","placeholder","trade@example.com"],["matSuffix",""],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"auth-form__error"],["matButton","filled","color","primary","type","submit",1,"auth-form__submit-btn",3,"disabled"],[1,"auth-form__footer"],["matInput","","formControlName","displayName","placeholder","Your name"],[1,"auth-form__footer-text"],["routerLink","/register",1,"auth-form__link"],["routerLink","/login",1,"auth-form__link"]],template:function(r,a){if(r&1&&(i(0,"div",0)(1,"div",1)(2,"form",2),S("ngSubmit",function(){return a.onSubmit()}),i(3,"h2",3),u(4,ot,1,0)(5,nt,1,0),o(),u(6,rt,6,0,"mat-form-field",4),i(7,"mat-form-field",4)(8,"mat-label"),n(9,"Email"),o(),h(10,"input",5),i(11,"mat-icon",6),n(12,"email"),o()(),i(13,"mat-form-field",4)(14,"mat-label"),n(15,"Password"),o(),h(16,"input",7),i(17,"button",8),S("click",function(){return a.hidePassword=!a.hidePassword}),i(18,"mat-icon"),n(19),o()()(),u(20,mt,2,1,"div",9),i(21,"button",10),v(22,"async"),i(23,"span"),n(24),v(25,"capitalize"),o()(),i(26,"div",11),u(27,lt,4,0)(28,st,4,0),o()()()()),r&2){let p,c;m(2),f("formGroup",a.authForm),m(2),d((p=a.authState.state)==="login"?4:p==="register"?5:-1),m(2),d(a.authState.state==="register"?6:-1),m(10),f("type",a.hidePassword?"password":"text"),m(3),_(a.hidePassword?"visibility_off":"visibility"),m(),d(a.errorMessage?20:-1),m(),f("disabled",a.authForm.invalid||C(22,9,a.loaderService.isLoading$)),m(3),_(C(25,11,a.authState.state)),m(3),d((c=a.authState.state)==="login"?27:c==="register"?28:-1)}},dependencies:[I,$,G,D,O,q,U,z,V,X,W,K,Q,tt,Z,J,H,j,B,R,F,g],styles:[".auth-page[_ngcontent-%COMP%]{height:100%}.auth-page__container[_ngcontent-%COMP%]{width:90%;max-width:540px;padding:1em;border-radius:15px;border:1px solid var(--border-color)}.auth-page__container[_ngcontent-%COMP%]   .auth-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1em}"]})};export{et as AuthComponent};
